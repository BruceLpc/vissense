/*! { "name": "vissense", "version": "0.1.0-rc1", "copyright": "(c) 2014 tbk" } */
!function(a){"use strict";var b=-1,c={onVisible:function(a){var b=c.isSupported();if(!b||!c.hidden())return a(),b;var d=c.change(function(){c.hidden()||(c.unbind(d),a())});return d},change:function(a){if(!c.isSupported())return!1;b+=1;var d=b;return c._callbacks[d]=a,c._listen(),d},unbind:function(a){delete c._callbacks[a]},afterPrerendering:function(a){var b=c.isSupported(),d="prerender";if(!b||d!=c.state())return a(),b;var e=c.change(function(b,f){d!=f&&(c.unbind(e),a())});return e},hidden:function(){return!(!c._doc.hidden&&!c._doc.webkitHidden)},state:function(){return c._doc.visibilityState||c._doc.webkitVisibilityState||"visible"},isSupported:function(){return!(!c._doc.visibilityState&&!c._doc.webkitVisibilityState)},_doc:document||{},_callbacks:{},_change:function(a){var b=c.state();for(var d in c._callbacks)c._callbacks[d].call(c._doc,a,b)},_listen:function(){if(!c._init){var a="visibilitychange";c._doc.webkitVisibilityState&&(a="webkit"+a);var b=function(){c._change.apply(c,arguments)};c._doc.addEventListener?c._doc.addEventListener(a,b):c._doc.attachEvent(a,b),c._init=!0}}};"undefined"!=typeof module&&module.exports?module.exports=c:a.Visibility=c}(this),function(a,b,c){"use strict";function d(b){var c=b&&b.ownerDocument;return c?c.defaultView||c.parentWindow:a}function e(a,b){return function(){return a()?b():c}}function f(a,b,c){for(var d=-1,e=Object.keys(b),f=e.length;++d<f;){var g=e[d];a[g]=c?c(a[g],b[g],g,a,b):b[g]}return a}function g(){}function h(a){return a}function i(){return(new Date).getTime()}function j(b){return a.setTimeout(function(){b()},0)}function k(a){return a===Object(a)}function l(a,b){if(!k(a))return b;for(var c=Object.keys(b),d=0,e=c.length;e>d;d++){var f=c[d];void 0===a[f]&&(a[f]=b[f])}return a}function m(a){var b=a.getBoundingClientRect();return b.height===c||b.width===c?f({height:a.clientHeight,width:a.clientWidth},b):b}function n(b){var d=b?C._window(b):a;return d.innerWidth===c?{height:d.document.documentElement.clientHeight,width:d.document.documentElement.clientWidth}:{height:d.innerHeight,width:d.innerWidth}}function o(a){var b=m(a);if(!b||b.width<=0||b.height<=0)return!1;var c=n(a);return b.top>=0&&b.left>=0&&b.bottom<=c.height&&b.right<=c.width}function p(a){var b=m(a);if(!b||b.width<=0||b.height<=0)return!1;var c=n(a);return b.bottom>0&&b.right>0&&b.top<c.height&&b.left<c.width}function q(a){if(!a.offsetParent){var b=s(a,"position");if("fixed"!==b)return!1}return!0}function r(a){var b=C._window(a);if("undefined"==typeof a.style)return c;if(b.getComputedStyle)return b.getComputedStyle(a,null);if(a.currentStyle)return a.currentStyle;throw new Error("cannot determine effective stylesheet in this browser")}function s(a,b){var d=r(a);if(!d)return c;var e=d[b];return"inherit"===e&&a.parentNode.style?s(a.parentNode,b):e}function t(a){var b=s(a,"display");return"none"===b?!1:a.parentNode&&a.parentNode.style?t(a.parentNode):!0}function u(a){if(a===C._window(a).document)return!0;if(!a||!a.parentNode)return!1;if(!q(a))return!1;var b=t(a);if(b!==!0)return!1;var c=s(a,"visibility");return"hidden"===c||"collapse"===c?!1:!0}function v(a){if(!C.isInViewport(a)||!C.isVisibleByStyling(a)||!C.isPageVisible())return 0;var b=C._getBoundingClientRect(a),c=0,d=0,e=C.viewport(a);b.top>=0?c=Math.min(b.height,e.height-b.top):b.bottom>0&&(c=Math.min(e.height,b.bottom)),b.left>=0?d=Math.min(b.width,e.width-b.left):b.right>0&&(d=Math.min(e.width,b.right));var f=c*d/(b.height*b.width);return Math.max(f,0)}function w(a){return C.isPageVisible()&&C.isFullyInViewport(a)&&C.isVisibleByStyling(a)}function x(a){return C.isPageVisible()&&C.isInViewport(a)&&C.isVisibleByStyling(a)}function y(a){return!x(a)}function z(){return!!D}function A(){return D?!b.hidden():!0}function B(a){D&&b.change(a)}var C={_window:d,fireIf:e};C=f(C,{noop:g,identity:h,isObject:k,defaults:l,extend:f,now:i,defer:j}),C.viewport=n,C.isFullyInViewport=o,C.isInViewport=p,C._getBoundingClientRect=m,C._isDisplayed=t,C._findEffectiveStyle=r,C.isVisibleByStyling=u,C.percentage=v,C.isFullyVisible=w,C.isVisible=x,C.isHidden=y;var D=!!b&&!!b.change&&!!b.isSupported&&b.isSupported();C.isPageVisibilityAPIAvailable=z,C.isPageVisible=A,C.onPageVisibilityChange=B,a.VisSenseUtils=C}.call(this,window,window.Visibility||null),function(a,b,c){"use strict";function d(a,b){if(!(this instanceof d))return new d(a,b);if(!a||1!==a.nodeType)throw new Error("InvalidArgument: Not an element node");this._element=a,this._config=b||{}}d.prototype.percentage=function(){return c.percentage(this._element)},d.prototype.isFullyVisible=function(){return c.isFullyVisible(this._element)},d.prototype.isVisible=function(){return c.isVisible(this._element)},d.prototype.isHidden=function(){return c.isHidden(this._element)},d.prototype.fireIfFullyVisible=function(a){var b=this;return c.fireIf(function(){return b.isFullyVisible()},a)},d.prototype.fireIfVisible=function(a){var b=this;return c.fireIf(function(){return b.isVisible()},a)},d.prototype.fireIfHidden=function(a){var b=this;return c.fireIf(function(){return b.isHidden()},a)},d.prototype.getFullyVisibleThreshold=c.noop,d.fn=d.prototype,a.VisSense=d,a.VisSense.version="0.1.0-rc1"}(window,Math,window.VisSenseUtils);